import SparkGuest from './index';
import axios from 'axios';
import MockAdapter from 'axios-mock-adapter';

describe(`Spark Guest API`, () => {
  it(`is defined properly`, () => {
    const sparkGuest = new SparkGuest();
    expect(sparkGuest).toBeDefined();
    expect(sparkGuest.getFreeUser).toBeDefined();
  });
});

describe(`getFreeUser()`, () => {

  const mock = new MockAdapter(axios);
  let sparkGuest = null;

  beforeEach(() => {
    sparkGuest = new SparkGuest();
  });

  afterEach(() => {
    mock.restore();
  });

  it(`calls GET /users/states/free 200 OK`, () => {
    const apiResponse = {
      clientId: `abc123`
    };
    mock.onGet(`/users/states/free`).reply(200, apiResponse);
    sparkGuest.getFreeUser().then((data) => {
      expect(data).toBe(apiResponse);
    });
  });
});
